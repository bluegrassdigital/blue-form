{"version":3,"file":"blue-form.mjs","sources":["../modules/Checkbox.js","../modules/Radio.js","../modules/Select.js","../modules/Textarea.js","../modules/TextInput.js","../modules/utils.js","../modules/Input.js","../modules/Form.js"],"sourcesContent":["import { each, listenCollection, trigger } from 'blue-js'\n\n/**\n * CheckboxInput widget\n * @class\n * @private\n * @param {object} el The dom node to instantiate this class using\n * @param {string} fieldType The field type\n */\nclass Checkbox {\n  constructor (els, name, onChange) {\n    this.name = name\n    this.inputs = els\n    listenCollection(this.inputs, 'change', (event) => onChange(this, event))\n  }\n  getValue () {\n    if (this.inputs.length === 1) return this.inputs[0].value || 'on'\n    let val = []\n    each(this.inputs, (input) => {\n      if (input.checked) val.push(input.value || 'on')\n    })\n    return val.length === 0 ? null : val\n  }\n  setValue (value, suppress) {\n    value = Array.isArray(value) ? value : [value]\n    each(this.inputs, input => {\n      if (value.indexOf(input.value) !== -1) {\n        input.checked = true\n      } else {\n        input.checked = false\n      }\n    })\n    if (!suppress) trigger(this.inputs[0], 'change')\n  }\n}\n\nexport default Checkbox\n","import { listenCollection, trigger, each } from 'blue-js'\n\n/**\n * RadioInput widget\n * @class\n * @private\n * @param {object} el The dom node to instantiate this class using\n * @param {string} fieldType The field type\n */\nclass Radio {\n  constructor (els, name, onChange) {\n    this.name = name\n    this.inputs = els\n    listenCollection(this.inputs, 'change', event => onChange(this, event))\n  }\n  getValue () {\n    let selectedItem\n    each(this.inputs, (input) => {\n      if (input.checked) selectedItem = input\n    })\n    return selectedItem ? selectedItem.value : null\n  }\n  setValue (value, suppress) {\n    each(this.inputs, (input) => {\n      if (input.value === value) {\n        input.checked = true\n      } else {\n        input.checked = false\n      }\n    })\n    if (!suppress) trigger(this.inputs[0], 'change')\n  }\n}\n\nexport default Radio\n","import { filter, each, listen, trigger } from 'blue-js'\n\n/**\n * Select widget\n * @class\n * @private\n * @param {object} el The dom node to instantiate this class using\n * @param {string} fieldType The field type\n */\nclass Select {\n  constructor (els, name, onChange) {\n    this.name = name\n    this.select = els[0]\n\n    listen(this.select, 'change', event => onChange(this, event))\n  }\n  getValue () {\n    if (this.select.type === 'select-one') return this.select.value\n\n    var options = this.select.querySelectorAll('option')\n\n    const selectedOptions = filter(options, opt => opt.selected)\n\n    return selectedOptions.map(opt => opt.value)\n  }\n  getSelectedOptionText () {\n    var options = this.select.querySelectorAll('option')\n    return options[this.getSelectedIndex()].textContent\n  }\n  setValue (value, suppress) {\n    if (this.select.type === 'select-one') {\n      this.select.value = value\n    } else {\n      var options = this.select.querySelectorAll('option')\n      value = Array.isArray(value) ? value : [value]\n      each(options, option => {\n        if (value.indexOf(option.value) !== -1) {\n          option.selected = 'selected'\n        } else {\n          option.removeAttribute('selected')\n        }\n      })\n    }\n    if (!suppress) trigger(this.select, 'change')\n  }\n  /**\n   * Get index of selected option\n   * @returns {number} The index of the selected option (or -1)\n   */\n  getSelectedIndex () {\n    return this.select.selectedIndex\n  }\n  /**\n   * Set index of selected option\n   * @param {number} newIndex The index to set as selected\n   */\n  setSelectIndex (newIndex) {\n    this.select.selectedIndex = newIndex\n    trigger(this.select, 'change')\n  }\n  /**\n   * Get current options of the select\n   * @returns {array} An array representing the current Select options\n   */\n  getSelectOptions () {\n    var options = this.select.querySelectorAll('option')\n    let opts = []\n\n    each(options, (option) => {\n      let opt = {\n        Text: option.textContent,\n        Value: option.value || option.textContent\n      }\n      if (option.selected) opt.Selected = true\n      opts.push(opt)\n    })\n\n    return opts\n  }\n  /**\n   * Replace the options of a select element\n   * @param {Object[]} newOptions - An array of objects for each new select option\n   * @param {string} newOptions[].Text - The text value of the new select option.\n   * @param {string|number} newOptions[].Value - The value of the new select option.\n   * @param {bool} [newOptions[].Selected] - Whether or not this option is selected.\n   * @param {bool} persist - Whether or not to persist the select at whatever it's value was prior to the change.\n   * @param {bool} keepFirstOption - Whether or not to keep the existing first option. Useful if the firt option is a default eg. 'Please select'.\n   */\n  changeSelectOptions (newOptions, persist, keepFirstOption) {\n    let originalValue = this.getValue()\n    let firstOption = keepFirstOption ? this.getSelectOptions()[0] : null\n    let options = firstOption ? [firstOption].concat(newOptions) : newOptions\n\n    this.suppressEvents = true\n    this.select.length = 0\n\n    options.forEach((option, i) => {\n      this.select[i] = option.Value ? new window.Option(option.Text, option.Value) : new window.Option(option.Text)\n    })\n\n    if (persist && originalValue) this.setValue(originalValue)\n\n    this.suppressEvents = false\n\n    trigger(this.select, 'change')\n  }\n}\n\nexport default Select\n","import { listen, trigger } from 'blue-js'\n\n/**\n * Textarea widget\n * @class\n * @private\n * @param {object} el The dom node to instantiate this class using\n * @param {string} fieldType The field type\n */\nclass Textarea {\n  constructor (els, name, onChange) {\n    this.name = name\n    this.textarea = els[0]\n    listen(this.textarea, 'input change', (event) => onChange(this, event))\n  }\n  getValue () {\n    return this.textarea.value\n  }\n  setValue (value, suppress) {\n    this.textarea.value = value\n    if (!suppress) trigger(this.textarea, 'change')\n  }\n}\n\nexport default Textarea\n","import { listen, trigger } from 'blue-js'\n\n/**\n * TextInput widget\n * @class\n * @private\n * @param {object} el The dom node to instantiate this class using\n * @param {string} fieldType The field type\n */\nclass TextInput {\n  constructor (els, name, onChange) {\n    this.name = name\n    this.input = els[0]\n    listen(this.input, 'input change', (event) => onChange(this, event))\n  }\n  getValue () {\n    return this.input.value\n  }\n  setValue (value, suppress) {\n    this.input.value = value\n    if (!suppress) trigger(this.input, 'change')\n  }\n}\n\nexport default TextInput\n","import { Checkbox, Radio, Select, Textarea, TextInput } from './inputTypes'\n\nexport function getTypeClass (fieldType) {\n  switch (fieldType) {\n    case 'select-one':\n    case 'select-multiple':\n      return Select\n    case 'radio':\n      return Radio\n    case 'checkbox':\n      return Checkbox\n    case 'textarea':\n      return Textarea\n    case 'text':\n    case 'email':\n    case 'password':\n    case 'search':\n    case 'tel':\n    case 'url':\n    case 'number':\n    case 'color':\n    case 'range':\n    case 'hidden':\n    case 'date':\n    case 'month':\n    case 'week':\n    case 'datetime':\n      return TextInput\n  }\n}\n\nexport function createField (name, onValueChange) {\n  if (name === '') return false\n  const matchedFields = document.querySelectorAll(`[name=${name}]`)\n  const TypeClass = getTypeClass(matchedFields[0].type)\n  if (TypeClass) return new TypeClass(matchedFields, name, onValueChange)\n}\n","import { createField } from './utils'\n\nclass Input {\n  constructor(el, onChange) {\n    this.field = createField(el.name, onChange)\n  }\n  getValue() {\n    return this.field.getValue()\n  }\n  setValue(value, suppress) {\n    return this.field.setValue(value, suppress)\n  }\n}\n\nexport default Input\n","import { createField } from './utils'\n\nclass Form {\n  constructor (el, opts) {\n    this.el = el\n    this.fields = {}\n\n    this.options = opts || {}\n\n    this.onFieldUpdated = this.onFieldUpdated.bind(this)\n\n    this.createFields()\n  }\n  createFields () {\n    this.fieldEls = this.el.querySelectorAll('input[name], select[name], textarea[name]')\n    for (let i = 0; i < this.fieldEls.length; i++) {\n      const el = this.fieldEls[i]\n      if (!this.fields[el.name]) {\n        const field = createField(el.name, this.onFieldUpdated)\n        if (field) this.fields[el.name] = field\n      }\n    }\n  }\n  /**\n   * Programmatically reset the form to its original state\n   */\n  reset () {\n    if (this.el.reset) this.el.reset()\n  }\n  onFieldUpdated (field, event) {\n    if (typeof this.options.onFieldUpdated === 'function') this.options.onFieldUpdated(field, event)\n  }\n  /**\n   * Set values of the forms fields to the new values\n   * @param {Object} newValues - An object of key value pairs corresponding to field names and values to update.\n   */\n  setFieldValues (newValues, suppress = false) {\n    this.createFields()\n    for (let field in this.fields) {\n      if (newValues[field] && this.fields.hasOwnProperty(field)) {\n        this.fields[field].setValue(newValues[field], suppress)\n      }\n    }\n  }\n  /**\n   * Get values of all child fields\n   * @returns {Object} An object of key value pairs of form field values\n   */\n  getFieldValues () {\n    this.createFields()\n    let fieldValues = {}\n    for (let field in this.fields) {\n      if (field && this.fields.hasOwnProperty(field)) {\n        fieldValues[field] = this.fields[field].getValue()\n      }\n    }\n    return fieldValues\n  }\n}\n\nexport default Form\n"],"names":["Checkbox","constructor","els","name","onChange","inputs","listenCollection","this","event","getValue","length","value","val","input","checked","push","setValue","suppress","Array","isArray","indexOf","trigger","Radio","selectedItem","Select","select","listen","type","options","querySelectorAll","filter","opt","selected","map","getSelectedOptionText","getSelectedIndex","textContent","each","option","removeAttribute","selectedIndex","setSelectIndex","newIndex","getSelectOptions","opts","Text","Selected","changeSelectOptions","newOptions","persist","keepFirstOption","originalValue","firstOption","concat","suppressEvents","forEach","i","Value","window","Option","Textarea","textarea","TextInput","createField","onValueChange","matchedFields","document","TypeClass","fieldType","getTypeClass","Input","el","field","Form","fields","onFieldUpdated","bind","createFields","fieldEls","let","reset","setFieldValues","newValues","hasOwnProperty","getFieldValues","fieldValues"],"mappings":"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"}